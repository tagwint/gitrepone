#!/bin/bash
NOFS=$(tmux ls | awk -F: '{ print $1 }' |  wc -l )
if [[ $NOFS -eq 0 ]] 
then 
  echo No session to attach
  echo Use
  echo  tmux new -s YourSessionName 
  echo to create your new session
else
  SELPATT=${1}
  if [ "$SELPATT" ]
  then 
    HSELOPT=" -q $SELPATT"
  else 
    HSELOPT=
  fi

  SLINE=$(tmux list-panes -aF "#S:#I.#P #T S:#{pane_start_command} C:#{pane_current_command} #{pane_pid}" |   fzf $HSELOPT)
  [ "$?" -gt 0 ] && exit 
  SP=$(awk ' { print $1 } ' <<<"$SLINE")
  tmux select-pane -t "$SP"
  if [ -z "${TMUX}" ] 
  then 
    tmux a -t  "$SP" 
  else 
    tmux switch-client -t "$SP" 
  fi
fi
